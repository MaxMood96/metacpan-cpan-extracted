!function(){"use strict";var e=angular.module("llApp",["ngAria"]);e.provider("$translator",function(){var e,t,r,n,a,i,o,s,l,u,c,d={};if(decodeURIComponent(document.cookie).match(/llnglanguage=(\w+)/))d.lang=RegExp.$1;else if(navigator){for(n=[],a=[],l=[navigator.language],t=0,i=(l=navigator.languages?navigator.languages:l).length;t<i;t++)for(s=l[t],console.debug("Navigator lang",s),r=0,o=(c=window.availableLanguages).length;r<o;r++)e=c[r],console.debug(" Available lang",e),u=new RegExp("^"+e+"-?"),s.match(u)?(console.debug("  Matching lang =",e),n.push(e)):e.substring(0,1)===s.substring(0,1)&&a.push(e);d.lang=n[0]||a[0]||"en"}else d.lang="en";return console.debug("Selected lang ->",d.lang),d.deferredTr=[],d.translationFields={},d.translate=function(e){return e=d.translationFields[e]?d.translationFields[e]:e},d.translateField=function(e,t){return d.translate(e[t])},d.translateP=function(e){return e=e&&d.translationFields.portal?e.replace(/__(\w+)__/g,function(e,t){return d.translate(t)}):e},this.$get=["$q","$http",function(t,r){return d.last="",d.init=function(e){var i;return e=e||d.lang,(i=new Date).setTime(i.getTime()+2592e6),document.cookie=`llnglanguage=${e}; expires=${i.toUTCString()}; path=/`,i=t.defer(),d.last!==e?(d.last=e,r.get(window.staticPrefix+`languages/${e}.json`).then(function(e){var t,r,n,a;for(d.translationFields=e.data,r=0,n=(a=d.deferredTr).length;r<n;r++)(t=a[r]).e[t.f](d.translationFields[t.m]);return d.deferredTr=[],i.resolve("Translation files loaded")},function(e){return i.reject("")})):i.resolve("No change"),i.promise},d}],this}),e.directive("trspan",["$translator",function(n){return{restrict:"A",replace:!1,transclude:!0,scope:{trspan:"@"},link:function(e,t,r){return n.translationFields.portal?r.trspan=n.translate(r.trspan):n.deferredTr.push({e:t,f:"text",m:r.trspan}),t.text(r.trspan)},template:""}}]),e.provider("$htmlParams",function(){return this.$get=function(){var r={};return{set:function(e,t){return r[e]=t},menu:function(){return r.menu},params:function(){return r.params}}},this}),e.directive("script",["$htmlParams",function(r){return{restrict:"E",terminal:!0,compile:function(e,t){if(t.type&&(t=t.type.match(/text\/(menu|parameters)/)))try{return r.set(t[1],JSON.parse(e[0].text))}catch(e){console.error("Parsing error:",e)}}}}]),e.controller("ModalInstanceCtrl",["$scope","$uibModalInstance","elem","set","init",function(a,e,t,r,n){var i,o;return a.elem=t,a.set=r,a.result=n,a.staticPrefix=window.staticPrefix,i=t("currentNode"),a.translateP=t("translateP"),i&&(o=i.data,a.currentNode=i),a.ok=function(){return r("result",a.result),e.close(!0)},a.cancel=function(){return i&&(a.currentNode.data=o),e.dismiss("cancel")},a.inSelect=function(e){for(var t=a.currentNode.select,r=0,n=t.length;r<n;r++)if(t[r].k===e)return!0;return!1}}]),e.directive("onReadFile",["$parse",function(a){return{restrict:"A",scope:!1,link:function(r,e,t){var n=a(t.onReadFile);return e.on("change",function(e){var t=new FileReader;return t.onload=function(e){return r.$apply(function(){return n(r,{$fileContent:e.target.result})})},t.readAsText((e.srcElement||e.target).files[0])})}}}]),e.directive("resizer",["$document",function(i){var o=null,s=null;return function(e,t,r){var n,a;return t.on("mousedown",function(e){return"vertical"===r.resizer?s=$(r.resizerRight).width()+$(r.resizerLeft).width():o=$(r.resizerTop).height()+$(r.resizerBottom).height(),e.preventDefault(),i.on("mousemove",n),i.on("mouseup",a)}),n=function(e){var t;return"vertical"===r.resizer?(t=e.pageX,r.resizerMax&&t>r.resizerMax&&(t=parseInt(r.resizerMax)),$(r.resizerLeft).css({width:t+"px"}),$(r.resizerRight).css({width:s-t+"px"})):(t=e.pageY-$("#navbar").height(),$(r.resizerTop).css({height:t+"px"}),$(r.resizerBottom).css({height:o-t+"px"}))},a=function(){return i.unbind("mousemove",n),i.unbind("mouseup",a)}}}]),e.factory("$lmhttp",["$q","$location",function(t,e){return{responseError:function(e){return 401===e.status&&window.portal?window.location=window.portal+"?url="+window.btoa(window.location).replace(/\//,"_"):t.reject(e)}}}]),e.config(["$httpProvider",function(e){return e.interceptors.push("$lmhttp")}])}();