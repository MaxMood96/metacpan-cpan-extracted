!function(){"use strict";function n(e,r,t){return(r=function(e){e=function(e,r){if("object"!=typeof e||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===r?String:Number)(e);t=t.call(e,r||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==typeof e?e:String(e)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var o=function(e,r){return $("#msg").attr("trspan",e),$("#msg").html(window.translate(e)),$("#color").removeClass("message-positive message-warning alert-success alert-warning alert-danger"),$("#color").addClass("message-".concat(r)),"positive"===r&&(r="success"),$("#color").addClass("alert-".concat(r)),$("#color").attr("role","status")},i=function(e,r,t){if(console.error("Error",t),(t=JSON.parse(e.responseText))&&t.error)return t=t.error.replace(/.* /,""),console.error("Returned error",t),t.match(/module/)?o("notAuthorized","warning"):"csrfToken"===t?(o(t,"danger"),setTimeout(function(){return window.location=window.location.href.split("?")[0]},2e3)):o(t,"warning")},e=function(r,t,e){return e=e||("UBK"===r?"yubikey":"TOTP"===r?"totp":"WebAuthn"===r?"webauthn":r.toLowerCase()),$.ajax(n({type:"POST",url:"".concat(scriptname,"2fregisters/").concat(e,"/delete"),data:{epoch:t},headers:{"X-CSRF-Check":"1"},dataType:"json",error:i,success:function(e){return e.error?e.error.match(/notAuthorized/)?o("notAuthorized","warning"):o("unknownAction","warning"):e.result?($("#delete-".concat(t)).hide(),e=jQuery.Event("mfaDeleted"),$(document).trigger(e,[{type:r,epoch:t}]),e.isDefaultPrevented()||o("yourKeyIsUnregistered","positive"),setTimeout(function(){return window.location=window.location.href.split("?")[0]},2e3)):void 0}},"error",i))};$(document).ready(function(){return $("body").on("click",".remove2f",function(){return e($(this).attr("device"),$(this).attr("epoch"),$(this).attr("prefix"))}),$("#goback").attr("href",portal),$(".data-epoch").each(function(){var e=new Date(1e3*$(this).text());return $(this).text(e.toLocaleString())})})}();