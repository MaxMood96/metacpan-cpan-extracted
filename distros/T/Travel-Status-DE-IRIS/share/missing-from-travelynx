#!/usr/bin/env perl

use strict;
use warnings;
use 5.010;

use File::Slurp qw(read_file write_file);
use JSON;
use Text::CSV;


my $json_str = read_file('stations.json');
my $stations = JSON->new->utf8->decode($json_str);
my %station = map { $_->{name} => $_ } @{$stations};

my @csv_lines = read_file( 'stops.csv', { binmode => ':utf8' } );
my $csv = Text::CSV->new;

# skip header
shift @csv_lines;

for my $line (@csv_lines) {
	if ($csv->parse($line)) {
		my ($name,$eva,$lat,$lon,$backend,$is_iris,$is_hafas) = $csv->fields;
		if ($is_iris and not $station{$name}) {
			say $name;
		}
	}
}
